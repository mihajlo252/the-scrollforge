import{r as c,j as t,s as b,c as x,b as g,u as y,g as j,a as v,C as w,m as C,B as N}from"./index-CDbZUcU8.js";const P=({source:r,alt:a,fallbackSrc:i})=>{const[d,s]=c.useState(r),[l,o]=c.useState(!1),[n,h]=c.useState(!1),u=()=>{l?n||(h(!0),s(i)):(o(!0),s(r.replace(".png",".jpg")))};return t.jsx("img",{src:d,alt:a,onError:u,className:`h-20 w-20 rounded-badge border-2 border-slate-900 ${n?"opacity-50 p-2":""}`})},S=async r=>{try{const{error:a}=await b.from("characters").delete().eq("id",r);if(a)throw a.message}catch(a){throw a}},E=x("/profile")({component:k});function k(){const{characters:r,setCharacters:a}=g(),{setCharacter:i}=y(),[d,s]=c.useState(!1),{user:l}=JSON.parse(j()),o=v(),n=()=>{a(l.id)},h=e=>{i(e),o({to:"/character"})},u=e=>{window.confirm("Are you sure you want to delete this character?")&&m(e)},m=async e=>{await S(e.id),s(!0)};return c.useEffect(()=>{n(),s(!1)},[d]),t.jsx(w,{getResetKey:()=>"reset",onCatch:()=>o({to:"/"}),children:t.jsx(C.main,{className:"flex h-full w-full gap-5",initial:{opacity:0},animate:{opacity:1},children:t.jsxs(N,{styles:"w-full flex flex-col items-start gap-10 p-5 overflow-y-scroll",children:[t.jsxs("section",{className:"flex w-full justify-between",children:[t.jsx("h1",{className:"text-5xl text-primary",children:l.user_metadata.username}),t.jsx("button",{onClick:()=>o({to:"/create-character/page1"}),className:"btn btn-ghost border-2 border-primary text-primary hover:border-primary hover:bg-primary hover:text-base-100",children:"Create Character"})]}),t.jsx("ul",{className:"w-full text-xl",children:r.map(e=>{var p,f;return t.jsxs("div",{className:"relative flex w-full items-center gap-5 rounded-badge border-2 border-slate-900 p-2 transition-colors hover:cursor-pointer hover:bg-slate-800",children:[t.jsxs("li",{className:"flex h-full w-full items-center gap-5",onClick:()=>h(e),children:[t.jsx(P,{source:`https://iyfoqgbhaxcedpmuvfkr.supabase.co/storage/v1/object/public/characters/${e.characterProfile.name.toLowerCase()}.png`,alt:e.characterProfile.name,fallbackSrc:"https://iyfoqgbhaxcedpmuvfkr.supabase.co/storage/v1/object/public/characters/avatarplaceholder.png"}),t.jsxs("div",{className:"text-start",children:[t.jsxs("p",{children:[e.characterProfile.name,", ",e.characterProfile.level]}),t.jsx("div",{className:"h-[.5px] w-full bg-neutral"}),t.jsxs("p",{children:[e.characterProfile.race," ",(p=e.characterProfile)==null?void 0:p.subrace,","," ",e.characterProfile.class," ",(f=e.characterProfile)==null?void 0:f.subclass]})]})]}),e.id!="fc42a10e-cba9-467b-adee-03ae8046ea78"&&t.jsx("button",{type:"button",onClick:()=>u(e),className:"btn btn-secondary absolute right-5 top-1/2 z-20 -translate-y-1/2",children:"Delete"})]},e.id)})})]})})})}export{E as Route};
