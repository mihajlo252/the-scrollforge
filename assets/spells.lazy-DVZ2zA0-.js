import{r as d,j as e,B as u,c as y,m as w}from"./index-C2frkvsY.js";import{D as b}from"./DeleteButton-CspM6M1H.js";import{s as x}from"./sendData-DlKGwLJR.js";import{A as f,P as g}from"./Popup-pxlJJpw0.js";const N=({spell:a,index:m,style:h,setSpells:o})=>{const[l,c]=d.useState(!1),{state:t}=JSON.parse(localStorage.getItem("character")??"{}"),r=async n=>{n.preventDefault(),await x("characters",t.character.id,{descriptions:{...t.character.descriptions,spells:t.character.descriptions.spells.filter(i=>i.name!==a.name)}}),o(t.character.descriptions.spells.filter(i=>i.name!==a.name)),localStorage.setItem("character",JSON.stringify({state:{...t,character:{...t.character,descriptions:{...t.character.descriptions,spells:[...t.character.descriptions.spells.filter(i=>i.name!==a.name)]}}}})),c(!1)};return e.jsxs(u,{styles:`relative grid w-full grid-cols-[1fr_3fr] h-min gap-5 text-lg px-10 py-5 border-accent ${h}`,children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("p",{className:"grid text-sm",children:[e.jsx("span",{className:"text-3xl underline",children:a.name}),a.type]}),e.jsxs("p",{children:["Range: ",a.range]}),e.jsxs("p",{children:["Casting Time: ",a.castingTime]}),e.jsxs("p",{children:["Range: ",a.range]}),e.jsxs("p",{children:["Duration: ",a.duration]}),e.jsxs("p",{children:["Components: ",a.components]}),e.jsx(b,{size:55,styles:" transition-colors rounded-badge  fill-base-300 hover:fill-slate-900 hover:stroke-secondary stroke-primary absolute bottom-5 right-0",event:()=>{c(!0)}}),e.jsx(f,{children:l&&e.jsx(g,{closerFunc:c,children:e.jsxs("form",{className:"flex flex-col gap-10",onSubmit:n=>r(n),children:[e.jsx("p",{children:"Are you sure you want to delete this spell?"}),e.jsxs("div",{className:"flex w-full gap-5",children:[e.jsx("button",{type:"button",className:"btn btn-primary flex-grow",onClick:()=>c(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-accent flex-grow",children:"Delete"})]})]})})})]}),e.jsx("pre",{children:e.jsx("p",{className:"w-full text-wrap break-words",children:a.description})})]},m)},T=y("/spells")({component:S});function S(){const{state:a}=JSON.parse(localStorage.getItem("character")??"{}"),{character:m}=a,[h,o]=d.useState(!1),[l,c]=d.useState(m.descriptions.spells||[]),[t,r]=d.useState({name:"",type:"",castingTime:"",range:"",duration:"",components:"",description:""}),n=(s,p)=>{s.preventDefault(),p(j=>({...j,[s.target.name]:s.target.value}))},i=async s=>{s.preventDefault(),await x("characters",a.character.id,{descriptions:{...a.character.descriptions,spells:[...a.character.descriptions.spells,t]}}),c([...l,t]),localStorage.setItem("character",JSON.stringify({state:{...a,character:{...a.character,descriptions:{...a.character.descriptions,spells:[...a.character.descriptions.spells,t]}}}})),o(!1)};return e.jsxs(w.main,{initial:{opacity:0},animate:{opacity:1},className:"h-full overflow-hidden",children:[e.jsx("button",{type:"button",className:"btn btn-accent absolute right-14 top-24 z-10",onClick:()=>o(!0),children:"Add"}),e.jsxs(u,{styles:"w-full h-full p-5 py-10 flex-col gap-5 text-start overflow-y-scroll",children:[l.map((s,p)=>e.jsx(N,{index:p,spell:s,setSpells:c},p)),e.jsx(f,{children:h&&e.jsx(g,{closerFunc:o,children:e.jsx("form",{onSubmit:s=>i(s),className:"flex w-min items-center justify-center",children:e.jsxs(u,{styles:"px-20 bg-opacity-90 py-10 justify-center flex-col gap-5 items-start text-start",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Spell Name",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.name)||"",onChange:s=>n(s,r)}),e.jsx("input",{type:"text",name:"type",placeholder:"Type",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.type)||"",onChange:s=>n(s,r)}),e.jsx("input",{type:"text",name:"castingTime",placeholder:"Casting Time",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.castingTime)||"",onChange:s=>n(s,r)}),e.jsx("input",{type:"text",name:"range",placeholder:"Range",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.range)||"",onChange:s=>n(s,r)}),e.jsx("input",{type:"text",name:"duration",placeholder:"Duration",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.duration)||"",onChange:s=>n(s,r)}),e.jsx("input",{type:"text",name:"components",placeholder:"Components",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.components)||"",onChange:s=>n(s,r)}),e.jsx("textarea",{name:"description",placeholder:"Description",className:"textarea resize-none focus-within:outline-0",rows:2,cols:50,value:(t==null?void 0:t.description)||"",onChange:s=>n(s,r)}),e.jsxs("div",{className:"flex w-full gap-5",children:[e.jsx("button",{type:"submit",className:"btn btn-accent flex-grow",children:"Add"}),e.jsx("button",{type:"button",className:"btn btn-secondary flex-grow",onClick:()=>o(!1),children:"Close"})]})]})})})})]})]})}export{T as Route};
