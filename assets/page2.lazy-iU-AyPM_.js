import{R as y,r as p,j as e,s as b,c as w,a as N,m as C,g as S}from"./index-IwxU2pCk.js";import{B as f}from"./BoxSection-BM-GbUJy.js";const j=({traits:s,setTraits:c,isSave:r,setIsSave:l,description:u})=>{const[a,n]=y.useState(""),[o,d]=y.useState(!1),i=()=>{c([...s,a]),n(""),l(!0)},x=()=>{localStorage.setItem("newCharacter",JSON.stringify({state:{character:{...JSON.parse(localStorage.getItem("newCharacter")||"{}").state.character,descriptions:{...JSON.parse(localStorage.getItem("newCharacter")||"{}").state.character.descriptions,[u]:s}}}})),l(!1)};return p.useEffect(()=>{r&&x()},[r]),e.jsxs("div",{className:"relative flex h-full w-full flex-col gap-8",children:[e.jsx("button",{type:"button",className:"btn btn-accent sticky top-5 z-20 self-end",onClick:()=>d(!o),children:o?"Close":"Add New"}),s.map((h,t)=>e.jsx("pre",{children:e.jsx("p",{className:"w-full text-wrap break-words",children:h})},t)),e.jsx("div",{className:`flex flex-col justify-center items-center fixed top-1/2 -translate-y-1/2 py-10 z-50 left-1/2 -translate-x-1/2 ${o?"block":"hidden"}`,children:e.jsxs(f,{styles:"h-[unset] w-max px-20 bg-opacity-90 py-10 justify-center flex-col gap-5 items-center text-start",children:[e.jsx("textarea",{className:"textarea textarea-bordered max-w-lg resize-none",placeholder:"Trait",name:"trait",cols:100,rows:10,value:a,onChange:h=>n(h.target.value)}),e.jsx("button",{type:"button",className:"btn btn-accent w-full",onClick:i,children:"Add"})]})})]})},v=({attacks:s,setAttacks:c,isSave:r,setIsSave:l,description:u})=>{const[a,n]=p.useState(),[o,d]=p.useState(!1),i=(t,m)=>{t.preventDefault(),m(g=>({...g,[t.target.name]:t.target.value}))},x=()=>{localStorage.setItem("newCharacter",JSON.stringify({state:{character:{...JSON.parse(localStorage.getItem("newCharacter")||"{}").state.character,descriptions:{...JSON.parse(localStorage.getItem("newCharacter")||"{}").state.character.descriptions,[u]:s}}}})),l(!1)},h=t=>{t.preventDefault(),a&&(c([...s,a]),n({name:"",type:"",range:"",attack:"",damage:"",description:""})),l(!0)};return p.useEffect(()=>{r&&x()},[r]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex h-full w-full flex-col gap-5",children:[e.jsx("button",{type:"button",className:"btn btn-accent sticky top-5 z-20 self-end",onClick:()=>d(!o),children:o?"Close":"Add New"}),s.map((t,m)=>e.jsxs(f,{styles:"grid w-full grid-cols-[1fr_3fr] h-min gap-5 px-10 py-5 border-accent",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("p",{className:"grid text-sm",children:[e.jsx("span",{className:"text-3xl underline",children:t.name}),t.type]}),e.jsxs("p",{children:["Range: ",t.range]}),e.jsxs("p",{children:["Attack: ",t.attack]}),e.jsxs("p",{children:["Damage: ",t.damage]})]}),e.jsx("pre",{children:e.jsx("p",{className:"text-wrap break-words",children:t.description})})]},m)),e.jsx("div",{className:`flex h-full flex-col justify-center items-center fixed top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 z-50 py-10 ${o?"block":"hidden"}`,children:e.jsxs(f,{styles:"px-20 bg-opacity-90 py-10 justify-center flex-col gap-5 items-start text-start",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Attack Name",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.name)||"",onChange:t=>i(t,n)}),e.jsx("input",{type:"text",name:"type",placeholder:"Type",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.type)||"",onChange:t=>i(t,n)}),e.jsx("input",{type:"text",name:"range",placeholder:"Range",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.range)||"",onChange:t=>i(t,n)}),e.jsx("input",{type:"text",name:"attack",placeholder:"Attack",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.attack)||"",onChange:t=>i(t,n)}),e.jsx("input",{type:"text",name:"damage",placeholder:"Damage",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.damage)||"",onChange:t=>i(t,n)}),e.jsx("textarea",{name:"description",placeholder:"Description",className:"textarea resize-none focus-within:outline-0",rows:4,cols:50,value:(a==null?void 0:a.description)||"",onChange:t=>i(t,n)}),e.jsx("button",{type:"button",className:"btn btn-accent w-full",onClick:t=>h(t),children:"Add"})]})})]})})},T=({spells:s,setSpells:c,isSave:r,setIsSave:l,description:u})=>{const[a,n]=p.useState(),[o,d]=p.useState(!1),i=(t,m)=>{t.preventDefault(),m(g=>({...g,[t.target.name]:t.target.value}))},x=()=>{localStorage.setItem("newCharacter",JSON.stringify({state:{character:{...JSON.parse(localStorage.getItem("newCharacter")||"{}").state.character,descriptions:{...JSON.parse(localStorage.getItem("newCharacter")||"{}").state.character.descriptions,[u]:s}}}})),l(!1)},h=t=>{t.preventDefault(),a&&(c([...s,a]),n({name:"",type:"",castingTime:"",range:"",duration:"",components:"",description:""})),l(!0)};return p.useEffect(()=>{r&&x()},[r]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative flex h-full w-full flex-col gap-5",children:[e.jsx("button",{type:"button",className:"btn btn-accent sticky top-5 z-20 self-end",onClick:()=>d(!o),children:o?"Close":"Add New"}),s.map((t,m)=>e.jsxs(f,{styles:"grid w-full grid-cols-[1fr_3fr] h-min gap-5 px-10 py-5 border-accent",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("p",{className:"grid text-sm",children:[e.jsx("span",{className:"text-3xl underline",children:t.name}),t.type]}),e.jsxs("p",{children:["Casting Time: ",t.castingTime]}),e.jsxs("p",{children:["Range: ",t.range]}),e.jsxs("p",{children:["Duration: ",t.duration]}),e.jsxs("p",{children:["Components: ",t.components]})]}),e.jsx("pre",{children:e.jsx("p",{className:"text-wrap break-words",children:t.description})})]},m)),e.jsx("div",{className:`flex h-full flex-col justify-center items-center fixed top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 z-50 py-10 ${o?"block":"hidden"}`,children:e.jsxs(f,{styles:"px-20 bg-opacity-90 py-10 justify-center flex-col gap-5 items-start text-start",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Spell Name",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.name)||"",onChange:t=>i(t,n)}),e.jsx("input",{type:"text",name:"type",placeholder:"Type",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.type)||"",onChange:t=>i(t,n)}),e.jsx("input",{type:"text",name:"castingTime",placeholder:"Casting Time",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.castingTime)||"",onChange:t=>i(t,n)}),e.jsx("input",{type:"text",name:"range",placeholder:"Range",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.range)||"",onChange:t=>i(t,n)}),e.jsx("input",{type:"text",name:"duration",placeholder:"Duration",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.duration)||"",onChange:t=>i(t,n)}),e.jsx("input",{type:"text",name:"components",placeholder:"Components",className:"input w-full focus-within:outline-0",value:(a==null?void 0:a.components)||"",onChange:t=>i(t,n)}),e.jsx("textarea",{name:"description",placeholder:"Description",className:"textarea resize-none focus-within:outline-0",rows:4,cols:50,value:(a==null?void 0:a.description)||"",onChange:t=>i(t,n)}),e.jsx("button",{type:"button",className:"btn btn-accent w-full",onClick:t=>h(t),children:"Add"})]})})]})})},k=({description:s})=>{const{state:c}=JSON.parse(localStorage.getItem("newCharacter")||"{}"),[r,l]=p.useState(!1),[u,a]=p.useState(c==null?void 0:c.character.descriptions.racialTraits),[n,o]=p.useState(c==null?void 0:c.character.descriptions.featureTraits),[d,i]=p.useState(c==null?void 0:c.character.descriptions.attacks),[x,h]=p.useState([]);if(s==="racialTraits")return e.jsx(j,{traits:u,setTraits:a,isSave:r,setIsSave:l,description:s});if(s==="featureTraits")return e.jsx(j,{traits:n,setTraits:o,isSave:r,setIsSave:l,description:s});if(s==="attacks")return e.jsx(v,{attacks:d,setAttacks:i,isSave:r,setIsSave:l,description:s});if(s==="spells")return e.jsx(T,{spells:x,setSpells:h,isSave:r,setIsSave:l,description:s})},A=async(s,c)=>{try{const{error:r}=await b.from("characters").insert({name:s.name,characterProfile:s.characterProfile,stats:s.stats,descriptions:s.descriptions,currentHP:s.currentHP,profileID:c});if(r)throw r.message}catch(r){throw r}},O=w("/create-character/page2")({component:D});function D(){const[s,c]=p.useState("racialTraits"),r=N(),l=a=>{c(a)},u=async a=>{a.preventDefault();const n=JSON.parse(localStorage.getItem("newCharacter")||"{}").state.character,{user:o}=JSON.parse(S());console.log(o);const d=A(n,o.id);console.log(d)};return e.jsxs(C.div,{className:"flex h-full w-full gap-2 overflow-hidden",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("button",{type:"submit",className:"align-self-end btn btn-ghost w-[2%] self-center rounded-lg border-2 border-slate-900 bg-base-300 text-neutral",onClick:()=>r({to:"/create-character/page1"}),children:"<"}),e.jsxs(f,{styles:"w-full px-5 flex-col text-start gap-2 overflow-y-scroll pt-0",children:[e.jsxs("div",{className:"sticky -top-5 z-10 flex w-full gap-2 bg-base-300 pt-5",children:[e.jsx("button",{type:"button",onClick:()=>l("racialTraits"),className:`btn ${s==="racialTraits"?"btn-primary":""}`,children:"Racial Traits"}),e.jsx("button",{type:"button",onClick:()=>l("featureTraits"),className:`btn ${s==="featureTraits"?"btn-primary":""}`,children:"Features & Traits"}),e.jsx("button",{type:"button",onClick:()=>l("attacks"),className:`btn ${s==="attacks"?"btn-primary":""}`,children:"Attacks"}),e.jsx("button",{type:"button",onClick:()=>l("spells"),className:`btn ${s==="spells"?"btn-primary":""}`,children:"Spells"})]}),e.jsx(k,{description:s})]}),e.jsx("button",{type:"submit",className:"align-self-end btn btn-ghost w-[2%] self-center rounded-lg border-2 border-slate-900 bg-base-300 text-neutral",onClick:u,children:">"})]})}export{O as Route};
