import{r as d,j as e,B as u,c as j,m as b}from"./index-BEiqE8-B.js";import{D as w}from"./DeleteButton-CCy2u7X7.js";import{A as x,P as f}from"./Popup-CnJBwWHl.js";import{s as g}from"./sendData-Q7HiRG4-.js";const N=({attack:a,index:h,style:m,setAttacks:i})=>{const[o,l]=d.useState(!1),{state:t}=JSON.parse(localStorage.getItem("character")??"{}"),c=async n=>{n.preventDefault(),await g("characters",t.character.id,{descriptions:{...t.character.descriptions,attacks:t.character.descriptions.attacks.filter(r=>r.name!==a.name)}}),i(t.character.descriptions.attacks.filter(r=>r.name!==a.name)),localStorage.setItem("character",JSON.stringify({state:{...t,character:{...t.character,descriptions:{...t.character.descriptions,attacks:[...t.character.descriptions.attacks.filter(r=>r.name!==a.name)]}}}})),l(!1)};return e.jsxs(u,{styles:`relative grid w-full h-min grid-cols-[1fr_3fr] gap-5 text-lg px-10 py-5 border-accent ${m}`,children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("p",{className:"grid text-sm",children:[e.jsx("span",{className:"text-3xl underline",children:a.name}),a.type]}),e.jsxs("p",{children:["Range: ",a.range]}),e.jsxs("p",{children:["Attack: ",a.attack]}),e.jsxs("p",{children:["Damage: ",a.damage]}),e.jsx(w,{size:55,styles:" transition-colors rounded-badge  fill-base-300 hover:fill-slate-900 hover:stroke-secondary stroke-primary absolute bottom-5 right-0",event:()=>{l(!0)}}),e.jsx(x,{children:o&&e.jsx(f,{closerFunc:l,children:e.jsxs("form",{className:"flex flex-col gap-10",onSubmit:n=>c(n),children:[e.jsx("p",{children:"Are you sure you want to delete this attack?"}),e.jsxs("div",{className:"flex w-full gap-5",children:[e.jsx("button",{type:"button",className:"btn btn-primary flex-grow",onClick:()=>l(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-accent flex-grow",children:"Delete"})]})]})})})]}),e.jsx("p",{children:a.description.split(`
`).map((n,r)=>e.jsx("span",{className:"block indent-5",children:n},r))})]},h)},k=j("/attacks")({component:v});function v(){const{state:a}=JSON.parse(localStorage.getItem("character")??"{}"),{character:h}=a,[m,i]=d.useState(!1),[o,l]=d.useState(h.descriptions.attacks||[]),[t,c]=d.useState({name:"",type:"",range:"",attack:"",damage:"",description:""}),n=(s,p)=>{s.preventDefault(),p(y=>({...y,[s.target.name]:s.target.value}))},r=async s=>{s.preventDefault(),await g("characters",a.character.id,{descriptions:{...a.character.descriptions,attacks:[...a.character.descriptions.attacks,t]}}),l([...o,t]),localStorage.setItem("character",JSON.stringify({state:{...a,character:{...a.character,descriptions:{...a.character.descriptions,attacks:[...a.character.descriptions.attacks,t]}}}})),i(!1)};return e.jsxs(b.main,{initial:{opacity:0},animate:{opacity:1},className:"h-full overflow-hidden",children:[e.jsx("button",{type:"button",className:"btn btn-accent absolute right-14 top-24 z-10",onClick:()=>i(!0),children:"Add"}),e.jsxs(u,{styles:"w-full h-full p-5 py-10 flex-col gap-5 text-start overflow-y-scroll",children:[o.map((s,p)=>e.jsx(N,{index:p,attack:s,setAttacks:l},p)),e.jsx(x,{children:m&&e.jsx(f,{closerFunc:i,children:e.jsx("form",{onSubmit:s=>r(s),className:"flex w-min items-center justify-center",children:e.jsxs(u,{styles:"px-20 bg-opacity-90 py-10 justify-center flex-col gap-5 items-start text-start",children:[e.jsx("input",{type:"text",name:"name",placeholder:"Attack Name",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.name)||"",onChange:s=>n(s,c)}),e.jsx("input",{type:"text",name:"type",placeholder:"Type",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.type)||"",onChange:s=>n(s,c)}),e.jsx("input",{type:"text",name:"range",placeholder:"Range",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.range)||"",onChange:s=>n(s,c)}),e.jsx("input",{type:"text",name:"attack",placeholder:"Attack",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.attack)||"",onChange:s=>n(s,c)}),e.jsx("input",{type:"text",name:"damage",placeholder:"Damage",className:"input w-full focus-within:outline-0",value:(t==null?void 0:t.damage)||"",onChange:s=>n(s,c)}),e.jsx("textarea",{name:"description",placeholder:"Description",className:"textarea resize-none focus-within:outline-0",rows:4,cols:50,value:(t==null?void 0:t.description)||"",onChange:s=>n(s,c)}),e.jsxs("div",{className:"flex w-full gap-5",children:[e.jsx("button",{type:"submit",className:"btn btn-accent flex-grow",children:"Add"}),e.jsx("button",{type:"button",className:"btn btn-secondary flex-grow",onClick:()=>i(!1),children:"Close"})]})]})})})})]})]})}export{k as Route};
